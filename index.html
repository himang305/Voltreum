<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Voltreum</title>
    <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
		
<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
</head>
<style>


	 .btn {
	  position: absolute;
	  top: 65%;
	  left: 50%;
	  transform: translate(-50%, -50%);
	  -ms-transform: translate(-50%, -50%);
	  background-color: rgb(18, 10, 10);
	  color: white;
	  font-size: 16px;
	  padding: 12px 24px;
	  border: none;
	  cursor: pointer;
	  border-radius: 5px;
	  text-align: center;
	}
	
	.btn:hover {
	  background-color: yellowgreen;
	}
	</style>
<body>
	<image style="height: 100%; width: 100%;" src="vol.jpg">
	<button id="btn" class="btn" onclick="load()"> Connect Wallet </button>
    
    Voltreum Wallet : 0x572BE585A20A3579bcB96A3348fB4e2dA1B58980<br>
    Balance: <span id="owner_balance"> </span><br><br>
    
    <button type="button" onclick="approve()">Approve Token to Voltreum</button> <br><br>

    Your Wallet :<span id="wallet"> </span><br>
	Your Pending Payment : 0.5 Voltz INRC <br>
    <button type="button" onclick="load()">PAY NOW</button> <br><br>
    
    SEND PAYMENTS TO PRODUCERS<br>
    Producers Wallets :<input type="text" id="producers" name="producers"><br>
	Amounts in Voltz INRC:<input type="text" id="amounts" name="amounts"><br>
    <button type="button" onclick="load()">SEND NOW</button>

</body>	

<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script>
        const tokenABI = [
	{
		"inputs": [],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "spender",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "value",
				"type": "uint256"
			}
		],
		"name": "Approval",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "value",
				"type": "uint256"
			}
		],
		"name": "Transfer",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "spender",
				"type": "address"
			}
		],
		"name": "allowance",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "spender",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "approve",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_amount",
				"type": "uint256"
			}
		],
		"name": "approveTokenToVoltreum",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_coreAddress",
				"type": "address"
			}
		],
		"name": "assignCoreContractAddress",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "account",
				"type": "address"
			}
		],
		"name": "balanceOf",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "decimals",
		"outputs": [
			{
				"internalType": "uint8",
				"name": "",
				"type": "uint8"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "spender",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "subtractedValue",
				"type": "uint256"
			}
		],
		"name": "decreaseAllowance",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "spender",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "addedValue",
				"type": "uint256"
			}
		],
		"name": "increaseAllowance",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "mint",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "name",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "symbol",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "totalSupply",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "transfer",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "transferFrom",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	}
];
		const coreABI = [
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_token",
				"type": "address"
			}
		],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_amount",
				"type": "uint256"
			}
		],
		"name": "billPayment",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address[]",
				"name": "_to",
				"type": "address[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_values",
				"type": "uint256[]"
			}
		],
		"name": "sendPayments",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	}
];

const tokenAddress =  0x1FaBA667615fdbb5e9C0b37b977285152Efc451b;
const coreAddress = 0xc35df676A9251730B1e877AfDf630921B3e4Beb2;

</script>
    
<script>

async function loadWeb3() {
    if (window.ethereum) {
        window.web3 = new Web3(window.ethereum);
         let n = ethereum.chainId; 
           try {
                if(n != '0x1A8C'){  
					await window.ethereum.request({
                        method: 'wallet_addEthereumChain',
                        params: [
                            {
                                chainId: '0x1A8C',
                                chainName: 'GDCC Testnet',
                                rpcUrls: ['https://data-seed1.gdccoin.io/'],
                                blockExplorerUrls: ['Https://testnet.gdcscan.io'],
                                nativeCurrency: {
                                    symbol: 'GDCC',
                                    decimals: 18
                                }
                            }
                        ]});  
					
               	}
                 const accounts = await ethereum.request({method: 'eth_requestAccounts'})
						.then((resp) => {
							alert("Wallet Successfully Connected");
							load_data();
						})
						.catch((err) => {
							console.log(err);
						});
					
               } catch (err) {
                   console.log(err);
               }
    }else{
        alert('Please Install Metamask to continue');
    }
}

async function load_data(){
	window.contract = await loadTokenContract();
	const balance = await window.contract.methods.balanceOf("0x572BE585A20A3579bcB96A3348fB4e2dA1B58980").call();
	document.getElementById("owner_balance").textContent = balance + 'Voltz INRC';

}

async function loadTokenContract() {
    try {
        return await new window.web3.eth.Contract(tokenABI, tokenAddress);
    } catch (err) {
        console.log(err);
    }
}

async function loadcoreABIContract() {
    try {
        return await new window.web3.eth.Contract(coreABI, coreAddress);
    } catch (err) {
        console.log(err);
    }
}

async function getCurrentAccount() {
    try {
        const accounts = await window.web3.eth.getAccounts();
//        alert('Active Wallet Address : '+ accounts[0]);
        return accounts[0];
    } catch (err) {
        console.log(err);
    }
}

async function payBills() {
    try {
		window.contract = await loadContract();
        const account = await getCurrentAccount();
        var gas = await window.web3.eth.getGasPrice();        
        const coolNumber = await window.contract.methods.whiteListUser().send({from: account,gasPrice: gas})
                .on('transactionHash', function (hash) {
                    console.log(hash);
                    alert("You are whitelisted successfully");
					window.location = "index2.html";
                })
                // .on('receipt', function (receipt) {                                      
                // })
                .on('error', function (error, receipt) {
                    console.log(error);
                });
                return;
    } catch (err) {
        console.log(err);
    }

}

async function load() {
    try {
        await loadWeb3();
       
    } catch (err) {
        console.log(err);
    }
}

</script>
    
<!-- end of sixth section -->
<!-- jQuery library -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>

<!-- Popper JS -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>    
</html>
